<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WAYNAçš„éŠæˆ²å¤©å ‚ - V6.0 ç©¶æ¥µç‰ˆ</title>
    <style>
        :root {
            --primary: #00ADB5;
            --secondary: #FF2E63;
            --dark: #222831;
            --grey: #393E46;
            --light: #EEEEEE;
            --accent: #F9ED69;
        }
        body {
            font-family: 'å¾®è»Ÿæ­£é»‘é«”', sans-serif;
            background-color: var(--dark);
            color: var(--light);
            margin: 0;
            display: flex;
            height: 100vh;
            overflow: hidden;
        }
        
        /* Sidebar Navigation */
        #sidebar {
            width: 260px;
            background-color: var(--grey);
            padding: 20px;
            display: flex;
            flex-direction: column;
            overflow-y: auto;
            box-shadow: 2px 0 10px rgba(0,0,0,0.5);
            z-index: 10;
        }
        h1 { 
            font-size: 20px; 
            color: var(--primary); 
            text-align: center; 
            margin-bottom: 10px;
            border-bottom: 2px solid var(--secondary);
            padding-bottom: 10px;
        }
        
        /* Slack Timer */
        #slack-timer-box {
            background: rgba(0,0,0,0.3);
            border: 1px solid var(--secondary);
            border-radius: 8px;
            padding: 10px;
            text-align: center;
            margin-bottom: 10px;
        }
        #slack-timer { font-size: 20px; font-weight: bold; color: var(--accent); font-family: monospace; }
        .timer-label { font-size: 11px; color: #aaa; }

        .nav-header { font-size: 11px; color: #aaa; margin-top: 10px; margin-bottom: 3px; text-transform: uppercase; border-bottom: 1px solid #555; padding-bottom: 2px;}
        .nav-btn {
            background: none;
            border: none;
            color: var(--light);
            padding: 8px 12px;
            margin-bottom: 2px;
            cursor: pointer;
            text-align: left;
            transition: 0.2s;
            border-radius: 6px;
            font-size: 14px;
            width: 100%;
        }
        .nav-btn:hover { background-color: rgba(255,255,255,0.1); }
        .nav-btn.active {
            background-color: var(--primary);
            color: var(--dark);
            font-weight: bold;
            box-shadow: 0 0 10px var(--primary);
        }

        /* Main Game Area */
        #game-area {
            flex: 1;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
            background: radial-gradient(circle at center, #2d3436 0%, #222831 100%);
        }
        .game-section {
            display: none;
            background: rgba(0,0,0,0.4);
            padding: 20px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            text-align: center;
            width: 90%;
            max-width: 650px;
            border: 1px solid rgba(255,255,255,0.1);
            max-height: 98vh;
            overflow-y: auto;
        }
        .game-section.active { display: block; animation: fadeIn 0.4s; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* Controls */
        button.action-btn {
            background-color: var(--primary);
            color: var(--dark);
            border: none;
            padding: 8px 20px;
            font-size: 16px;
            cursor: pointer;
            border-radius: 50px;
            margin: 8px;
            font-weight: bold;
            transition: 0.2s;
            outline: none;
        }
        button.action-btn:hover { transform: scale(1.05); box-shadow: 0 0 15px var(--primary); }
        input { padding: 8px; font-size: 16px; width: 100px; text-align: center; border-radius: 5px; border: none; }
        .score-board { font-size: 18px; color: var(--secondary); font-weight: bold; margin: 10px 0; }
        canvas { background: #000; border: 2px solid var(--primary); margin: 0 auto; display: block; max-width: 100%; }

        /* --- Specific Game Styles --- */
        .board { display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; margin: 15px auto; width: 200px; }
        .cell { width: 60px; height: 60px; background: var(--grey); display: flex; align-items: center; justify-content: center; font-size: 36px; cursor: pointer; border-radius: 8px; }
        
        .mole-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; width: 220px; margin: 15px auto; }
        .mole-hole { width: 65px; height: 65px; background: #444; border-radius: 50%; position: relative; overflow: hidden; cursor: pointer; border: 3px solid #555; }
        .mole { width: 100%; height: 100%; background: var(--secondary); border-radius: 50%; position: absolute; top: 100%; transition: top 0.1s; }
        .mole-hole.active .mole { top: 0; }

        .memory-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; width: 280px; margin: 15px auto; }
        .memory-card { width: 60px; height: 60px; background: var(--primary); border-radius: 6px; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 28px; color: transparent; transition: transform 0.3s; }
        .memory-card.flipped { background: #fff; color: #333; transform: rotateY(180deg); }
        .memory-card.matched { background: var(--secondary); color: #fff; visibility: hidden; }

        #minesweeper-grid { display: grid; gap: 2px; margin: 15px auto; background: #555; padding: 2px; width: fit-content; }
        .mine-cell { width: 30px; height: 30px; background: #bbb; display: flex; align-items: center; justify-content: center; font-weight: bold; cursor: pointer; color: #000; font-size: 14px; }
        .mine-cell.revealed { background: #ddd; } .mine-cell.bomb { background: #e74c3c; }

        .slot-machine { display: flex; justify-content: center; gap: 10px; margin: 20px 0; background: #333; padding: 20px; border-radius: 10px; border: 4px solid var(--accent); }
        .slot-reel { width: 50px; height: 70px; background: #fff; border-radius: 5px; font-size: 36px; display: flex; align-items: center; justify-content: center; color: #333; }

        .simon-board { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; width: 200px; margin: 20px auto; }
        .simon-btn { height: 90px; border-radius: 10px; opacity: 0.6; cursor: pointer; transition: 0.1s; border: 2px solid #fff; }
        .simon-btn:active, .simon-btn.lit { opacity: 1; transform: scale(0.95); box-shadow: 0 0 20px currentColor; }
        .sb-r { background: #ff5252; color: #ff5252; } .sb-g { background: #69f0ae; color: #69f0ae; } .sb-b { background: #448aff; color: #448aff; } .sb-y { background: #ffff00; color: #ffff00; }

        .puzzle-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 4px; width: 240px; margin: 20px auto; background: #333; padding: 4px; }
        .puzzle-tile { width: 55px; height: 55px; background: var(--primary); display: flex; align-items: center; justify-content: center; font-size: 20px; font-weight: bold; cursor: pointer; color: var(--dark); border-radius: 4px; }
        .puzzle-tile.empty { background: transparent; cursor: default; }

        /* 2048 Styles */
        #grid-2048 { display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; background: #bbada0; padding: 8px; border-radius: 5px; width: 260px; margin: 10px auto; }
        .tile-2048 { width: 58px; height: 58px; background: #cdc1b4; border-radius: 3px; display: flex; align-items: center; justify-content: center; font-size: 24px; font-weight: bold; color: #776e65; }
        .t2 { background: #eee4da; } .t4 { background: #ede0c8; } .t8 { background: #f2b179; color: #fff; } .t16 { background: #f59563; color: #fff; } 
        .t32 { background: #f67c5f; color: #fff; } .t64 { background: #f65e3b; color: #fff; } .t128 { background: #edcf72; color: #fff; font-size: 20px; }

        /* Hangman */
        #hangman-word { font-size: 32px; letter-spacing: 5px; margin: 20px 0; font-family: monospace; }
        #hangman-keys { display: flex; flex-wrap: wrap; justify-content: center; gap: 5px; max-width: 400px; margin: 0 auto; }
        .key-btn { width: 30px; height: 30px; font-size: 14px; background: #555; color: #fff; border: none; border-radius: 4px; cursor: pointer; }
        .key-btn:disabled { opacity: 0.3; cursor: not-allowed; }

    </style>
</head>
<body>

    <div id="sidebar">
        <h1>WAYNAçš„<br>éŠæˆ²å¤©å ‚</h1>
        <div id="slack-timer-box">
            <div class="timer-label">æ‘¸é­šè¨ˆæ™‚å™¨</div>
            <div id="slack-timer">00:00:00</div>
        </div>
        <button class="nav-btn active" onclick="switchGame('welcome')">ğŸ  å¤§å»³é¦–é </button>

        <div class="nav-header">ç¬¬ä¸€å€: ç¶“å…¸</div>
        <button class="nav-btn" onclick="switchGame('game1')">â­•âŒ äº•å­—éŠæˆ²</button>
        <button class="nav-btn" onclick="switchGame('game2')">ğŸ”¢ çµ‚æ¥µå¯†ç¢¼</button>
        <button class="nav-btn" onclick="switchGame('game3')">âœŒâœŠâœ‹ çŒœæ‹³</button>
        <button class="nav-btn" onclick="switchGame('game4')">âš¡ æ‰‹é€Ÿç‹</button>
        <button class="nav-btn" onclick="switchGame('game5')">ğŸ¨ åæ‡‰åŠ›</button>

        <div class="nav-header">ç¬¬äºŒå€: æŠ€è¡“</div>
        <button class="nav-btn" onclick="switchGame('game6')">ğŸ è²ªé£Ÿè›‡</button>
        <button class="nav-btn" onclick="switchGame('game7')">ğŸ¹ æ‰“åœ°é¼ </button>
        <button class="nav-btn" onclick="switchGame('game8')">ğŸ´ è¨˜æ†¶ç¿»ç‰Œ</button>
        <button class="nav-btn" onclick="switchGame('game9')">ğŸš€ é–ƒé¿çƒ</button>
        <button class="nav-btn" onclick="switchGame('game10')">â• æ•¸å­¸éš¨å ‚è€ƒ</button>

        <div class="nav-header">ç¬¬ä¸‰å€: ä¼‘é–’</div>
        <button class="nav-btn" onclick="switchGame('game11')">ğŸ§± æ‰“ç£šå¡Š</button>
        <button class="nav-btn" onclick="switchGame('game12')">ğŸ’£ è¸©åœ°é›·</button>
        <button class="nav-btn" onclick="switchGame('game13')">ğŸ° å¹¸é‹æ‹‰éœ¸</button>
        <button class="nav-btn" onclick="switchGame('game14')">ğŸ§  åºåˆ—è¨˜æ†¶</button>
        <button class="nav-btn" onclick="switchGame('game15')">ğŸ§© æ•¸å­—æ¨ç›¤</button>

        <div class="nav-header">ç¬¬å››å€: ç©¶æ¥µ (New)</div>
        <button class="nav-btn" onclick="switchGame('game16')">ğŸ§± ä¿„ç¾…æ–¯æ–¹å¡Š</button>
        <button class="nav-btn" onclick="switchGame('game17')">ğŸ¦ é£›ç¿”å°é³¥</button>
        <button class="nav-btn" onclick="switchGame('game18')">ğŸ“ å¾©å¤ä¹’ä¹“</button>
        <button class="nav-btn" onclick="switchGame('game19')">ğŸ”¢ 2048</button>
        <button class="nav-btn" onclick="switchGame('game20')">ğŸ…°ï¸ è‹±æ–‡çŒœå­—</button>
    </div>

    <div id="game-area">
        
        <div id="welcome" class="game-section active">
            <h2 style="font-size: 32px; color: var(--primary);">WAYNAçš„éŠæˆ²å¤©å ‚ V6.0</h2>
            <p>ç›®å‰å·²æ”¶éŒ„ 20 æ¬¾éŠæˆ²ï¼Œå¤ ä½ ç©ä¸€æ•´å¤©ï¼</p>
            <p style="color: var(--accent);">æ‘¸é­šé›–å¥½ï¼Œè¨˜å¾—å¶çˆ¾æŠ¬é ­çœ‹çœ‹è€é—†åœ¨ä¸åœ¨ã€‚</p>
            <p style="font-size: 14px; color: #aaa;">æç¤ºï¼šå¤§éƒ¨åˆ†éŠæˆ²æ”¯æ´éµç›¤æ“ä½œï¼Œé»æ“Šé–‹å§‹å¾Œè«‹ç¢ºä¿ç„¦é»åœ¨éŠæˆ²å€ã€‚</p>
        </div>

        <div id="game1" class="game-section"><h2>äº•å­—éŠæˆ²</h2><div class="score-board" id="ttt-status">è¼ªåˆ°ä½  (X)</div><div class="board" id="ttt-board"></div><button class="action-btn" onclick="resetTTT()">é‡ç½®</button></div>
        <div id="game2" class="game-section"><h2>çµ‚æ¥µå¯†ç¢¼</h2><input type="number" id="guess-input" placeholder="?" onkeypress="if(event.key==='Enter') checkGuess()"><button class="action-btn" onclick="checkGuess()">çŒœ</button><div class="score-board" id="guess-result">æº–å‚™é–‹å§‹</div><button class="action-btn" onclick="resetGuess()">é‡ä¾†</button></div>
        <div id="game3" class="game-section"><h2>çŒœæ‹³</h2><div class="score-board" id="rps-score">0 - 0</div><div style="margin:20px;"><button class="action-btn" onclick="playRPS('âœŠ')">âœŠ</button><button class="action-btn" onclick="playRPS('âœ‹')">âœ‹</button><button class="action-btn" onclick="playRPS('âœŒ')">âœŒ</button></div><div id="rps-result">å‡ºæ‹³å§</div></div>
        <div id="game4" class="game-section"><h2>æ‰‹é€Ÿç‹</h2><div style="width:100px;height:100px;background:var(--secondary);border-radius:50%;margin:10px auto;display:flex;align-items:center;justify-content:center;cursor:pointer;user-select:none;" onmousedown="clickCount()">é»æˆ‘</div><div class="score-board"><span id="click-time">5.0</span>s | <span id="click-score">0</span></div><button class="action-btn" onclick="startClicker()">é–‹å§‹</button></div>
        <div id="game5" class="game-section"><h2>åæ‡‰åŠ›</h2><div id="reflex-box" style="width:100%;height:100px;background:#444;border-radius:10px;display:flex;align-items:center;justify-content:center;cursor:pointer;user-select:none;" onmousedown="reflexClick()">é»æ“Šé–‹å§‹</div><div class="score-board" id="reflex-msg"></div><button class="action-btn" onclick="startReflex()">æ¸¬è©¦</button></div>
        <div id="game6" class="game-section"><h2>è²ªé£Ÿè›‡</h2><div class="score-board">åˆ†æ•¸: <span id="snake-score">0</span></div><canvas id="snake-canvas" width="300" height="300"></canvas><p style="font-size:12px;">WASD æˆ– æ–¹å‘éµæ§åˆ¶</p><button class="action-btn" onclick="startSnake()">é–‹å§‹</button></div>
        <div id="game7" class="game-section"><h2>æ‰“åœ°é¼ </h2><div class="score-board"><span id="mole-score">0</span>åˆ† | <span id="mole-time">30</span>s</div><div class="mole-grid" id="mole-grid"></div><button class="action-btn" onclick="startMole()">é–‹å§‹</button></div>
        <div id="game8" class="game-section"><h2>è¨˜æ†¶ç¿»ç‰Œ</h2><div class="memory-grid" id="memory-grid"></div><button class="action-btn" onclick="initMemory()">é‡æ´—</button></div>
        <div id="game9" class="game-section"><h2>é–ƒé¿çƒ</h2><p style="font-size:12px;">å·¦å³éµèº²é¿</p><canvas id="dodge-canvas" width="300" height="300"></canvas><div class="score-board">å­˜æ´»: <span id="dodge-score">0</span></div><button class="action-btn" onclick="startDodge()">é–‹å§‹</button></div>
        <div id="game10" class="game-section"><h2>æ•¸å­¸éš¨å ‚è€ƒ</h2><div class="score-board">ç­”å°: <span id="math-score">0</span></div><div id="math-question" style="font-size:32px;margin:10px;">?</div><input type="number" id="math-input" placeholder="ç­”æ¡ˆ" onkeypress="if(event.key==='Enter') checkMath()"><button class="action-btn" onclick="checkMath()">é€å‡º</button></div>
        <div id="game11" class="game-section"><h2>æ‰“ç£šå¡Š</h2><div class="score-board">åˆ†æ•¸: <span id="break-score">0</span></div><canvas id="break-canvas" width="300" height="300"></canvas><p style="font-size:12px;">å·¦å³éµæ§åˆ¶</p><button class="action-btn" onclick="startBreakout()">é–‹å§‹</button></div>
        <div id="game12" class="game-section"><h2>è¸©åœ°é›·</h2><div id="minesweeper-grid"></div><div class="score-board" id="mine-msg"></div><button class="action-btn" onclick="initMinesweeper()">é‡ç½®</button></div>
        <div id="game13" class="game-section"><h2>å¹¸é‹æ‹‰éœ¸</h2><div class="slot-machine"><div class="slot-reel" id="reel1">7</div><div class="slot-reel" id="reel2">7</div><div class="slot-reel" id="reel3">7</div></div><div id="slot-msg">è©¦è©¦æ‰‹æ°£</div><button class="action-btn" onclick="spinSlots()">æ‹‰éœ¸</button></div>
        <div id="game14" class="game-section"><h2>åºåˆ—è¨˜æ†¶</h2><div class="score-board">Level: <span id="simon-level">1</span></div><div class="simon-board"><div class="simon-btn sb-r" id="sb-0" onclick="handleSimonInput(0)"></div><div class="simon-btn sb-g" id="sb-1" onclick="handleSimonInput(1)"></div><div class="simon-btn sb-b" id="sb-2" onclick="handleSimonInput(2)"></div><div class="simon-btn sb-y" id="sb-3" onclick="handleSimonInput(3)"></div></div><div id="simon-msg">é»æ“Šé–‹å§‹</div><button class="action-btn" onclick="startSimon()">é–‹å§‹</button></div>
        <div id="game15" class="game-section"><h2>æ•¸å­—æ¨ç›¤</h2><div class="puzzle-grid" id="puzzle-grid"></div><div id="puzzle-msg">æ’åˆ— 1-15</div><button class="action-btn" onclick="initPuzzle()">æ´—ç‰Œ</button></div>

        <div id="game16" class="game-section">
            <h2>ä¿„ç¾…æ–¯æ–¹å¡Š</h2>
            <div class="score-board">åˆ†æ•¸: <span id="tetris-score">0</span></div>
            <canvas id="tetris-canvas" width="240" height="400" style="background:#000; border:2px solid #555;"></canvas>
            <p style="font-size:12px;color:#aaa;">â¬†ï¸è®Šå½¢ â¬…ï¸â¡ï¸ç§»å‹• â¬‡ï¸åŠ é€Ÿ</p>
            <button class="action-btn" onclick="startTetris()">é–‹å§‹éŠæˆ²</button>
        </div>

        <div id="game17" class="game-section">
            <h2>é£›ç¿”å°é³¥</h2>
            <div class="score-board">åˆ†æ•¸: <span id="bird-score">0</span></div>
            <canvas id="bird-canvas" width="300" height="400"></canvas>
            <p style="font-size:12px;color:#aaa;">æŒ‰ ç©ºç™½éµ æˆ– é»æ“Š æ»‘é¼  é£›è¡Œ</p>
            <button class="action-btn" onclick="startBird()">é–‹å§‹é£›è¡Œ</button>
        </div>

        <div id="game18" class="game-section">
            <h2>å¾©å¤ä¹’ä¹“</h2>
            <div class="score-board"><span id="pong-user">0</span> : <span id="pong-cpu">0</span></div>
            <canvas id="pong-canvas" width="400" height="300"></canvas>
            <p style="font-size:12px;color:#aaa;">ä½¿ç”¨ W/S æˆ– ä¸Šä¸‹éµ æ§åˆ¶å·¦å´æ“‹æ¿</p>
            <button class="action-btn" onclick="startPong()">ç™¼çƒ</button>
        </div>

        <div id="game19" class="game-section">
            <h2>2048</h2>
            <div class="score-board">åˆ†æ•¸: <span id="g2048-score">0</span></div>
            <div id="grid-2048"></div>
            <p style="font-size:12px;color:#aaa;">ä½¿ç”¨ æ–¹å‘éµ æ»‘å‹•æ–¹å¡Š</p>
            <button class="action-btn" onclick="init2048()">é‡æ–°é–‹å§‹</button>
        </div>

        <div id="game20" class="game-section">
            <h2>è‹±æ–‡çŒœå­—</h2>
            <canvas id="hangman-canvas" width="200" height="150" style="border:none; background:transparent;"></canvas>
            <div id="hangman-word">_ _ _ _ _</div>
            <div id="hangman-keys"></div>
            <div class="score-board" id="hangman-msg">çŒœçŒœçœ‹?</div>
            <button class="action-btn" onclick="initHangman()">æ–°å–®å­—</button>
        </div>

    </div>

    <script>
        // --- Slack Timer ---
        let slkS=0; setInterval(()=>{ slkS++; document.getElementById('slack-timer').innerText=new Date(slkS*1000).toISOString().substr(11,8); },1000);

        // --- Core System ---
        let activeGame='welcome', intervals=[];
        function switchGame(id){
            intervals.forEach(clearInterval); intervals=[];
            document.querySelectorAll('.game-section').forEach(e=>e.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            document.querySelectorAll('.nav-btn').forEach(b=>{
                b.classList.remove('active');
                if(b.getAttribute('onclick').includes(id)) b.classList.add('active');
            });
            activeGame=id;
            if(document.activeElement) document.activeElement.blur();
            
            // Init specific
            if(id==='game7') createMoleGrid();
            if(id==='game8') initMemory();
            if(id==='game10') initMath();
            if(id==='game12') initMinesweeper();
            if(id==='game15') initPuzzle();
            if(id==='game19') init2048();
            if(id==='game20') initHangman();
        }

        // --- GLOBAL INPUT ---
        window.addEventListener('keydown', e=>{
            const k=e.key;
            // Prevent scroll for games using arrows/space
            if(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"," "].includes(k) && ['game6','game9','game11','game16','game17','game18','game19'].includes(activeGame)) e.preventDefault();

            // Routing
            if(activeGame==='game6') snakeKey(k);
            if(activeGame==='game9') dodgeKey(k,true);
            if(activeGame==='game11') breakKey(k,true);
            if(activeGame==='game16') tetrisKey(k);
            if(activeGame==='game17') birdKey(k);
            if(activeGame==='game18') pongKey(k,true);
            if(activeGame==='game19') handle2048(k);
        });
        window.addEventListener('keyup', e=>{
            if(activeGame==='game9') dodgeKey(e.key,false);
            if(activeGame==='game11') breakKey(e.key,false);
            if(activeGame==='game18') pongKey(e.key,false);
        });

        // --- Games 1-15 (Simplified from previous versions) ---
        // 1. TTT
        let tb=Array(9).fill(null);
        function resetTTT(){tb=Array(9).fill(null);rTTT();document.getElementById('ttt-status').innerText="è¼ªåˆ°ä½  (X)";}
        function rTTT(){const b=document.getElementById('ttt-board');b.innerHTML='';tb.forEach((v,i)=>{let c=document.createElement('div');c.className=`cell ${v?'taken':''}`;c.innerText=v||'';c.onclick=()=>pTTT(i);b.appendChild(c);});}
        function pTTT(i){if(tb[i]||cTTT(tb))return;tb[i]='X';rTTT();if(!cTTT(tb))setTimeout(cpuTTT,300);else eTTT();}
        function cpuTTT(){let a=tb.map((v,i)=>v===null?i:null).filter(v=>v!==null);if(a.length)tb[a[Math.floor(Math.random()*a.length)]]='O';rTTT();eTTT();}
        function cTTT(b){const w=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];for(let l of w)if(b[l[0]]&&b[l[0]]===b[l[1]]&&b[l[0]]===b[l[2]])return b[l[0]];return null;}
        function eTTT(){let w=cTTT(tb);let s=document.getElementById('ttt-status');if(w)s.innerText=w==='X'?"è´äº†!":"è¼¸äº†...";else if(!tb.includes(null))s.innerText="å¹³æ‰‹";}
        
        // 2. Guess
        let gT=Math.floor(Math.random()*100)+1;
        function checkGuess(){let v=parseInt(document.getElementById('guess-input').value),m=document.getElementById('guess-result');if(v===gT){m.innerText="ğŸ‰ çŒœå°äº†!";m.style.color="#00ADB5";}else m.innerText=v>gT?"å¤ªå¤§äº†":"å¤ªå°äº†";document.getElementById('guess-input').value='';}
        function resetGuess(){gT=Math.floor(Math.random()*100)+1;document.getElementById('guess-result').innerText="æ–°å±€å·²é–‹";}

        // 3. RPS
        function playRPS(u){const c=['âœŠ','âœ‹','âœŒ'][Math.floor(Math.random()*3)];let r="å¹³æ‰‹";if((u=='âœŠ'&&c=='âœŒ')||(u=='âœ‹'&&c=='âœŠ')||(u=='âœŒ'&&c=='âœ‹'))r="ä½ è´äº†";else if(u!==c)r="é›»è…¦è´";document.getElementById('rps-result').innerText=`ä½ ${u} vs ${c}é›»è…¦ -> ${r}`;}

        // 4. Clicker
        let clkS=0,clkA=false;
        function startClicker(){if(clkA)return;clkS=0;clkA=true;let t=5.0;document.getElementById('click-score').innerText=0;intervals.push(setInterval(()=>{t-=0.1;document.getElementById('click-time').innerText=t.toFixed(1);if(t<=0){clkA=false;document.getElementById('click-time').innerText="0.0";alert(`æˆç¸¾: ${clkS}`);intervals.forEach(clearInterval);}},100));}
        function clickCount(){if(clkA)document.getElementById('click-score').innerText=++clkS;}

        // 5. Reflex
        let refT;
        function startReflex(){let b=document.getElementById('reflex-box');b.style.background="#444";b.innerText="ç­‰å¾…è®Šç¶ ...";b.onmousedown=null;refT=setTimeout(()=>{b.style.background="#00ADB5";b.innerText="é»æ“Š!";let s=Date.now();b.onmousedown=()=>{document.getElementById('reflex-msg').innerText=`${Date.now()-s} ms`;b.onmousedown=null;}},1000+Math.random()*2000);}
        function reflexClick(){if(document.getElementById('reflex-box').style.background!=='rgb(0, 173, 181)'){clearTimeout(refT);document.getElementById('reflex-msg').innerText="å¤ªæ—©äº†!";}}

        // 6. Snake
        let snk=[],sfd={},sd,ssc=0; const sctx=document.getElementById('snake-canvas').getContext('2d');
        function startSnake(){if(document.activeElement)document.activeElement.blur();snk=[{x:135,y:150}];sfd={x:Math.floor(Math.random()*19)*15,y:Math.floor(Math.random()*19)*15};sd="RIGHT";ssc=0;document.getElementById('snake-score').innerText=0;intervals.forEach(clearInterval);intervals.push(setInterval(drawSnake,130));}
        function snakeKey(k){if((k=='ArrowLeft'||k=='a')&&sd!='RIGHT')sd='LEFT';if((k=='ArrowUp'||k=='w')&&sd!='DOWN')sd='UP';if((k=='ArrowRight'||k=='d')&&sd!='LEFT')sd='RIGHT';if((k=='ArrowDown'||k=='s')&&sd!='UP')sd='DOWN';}
        function drawSnake(){
            sctx.fillStyle='#222831';sctx.fillRect(0,0,300,300);
            for(let i=0;i<snk.length;i++){sctx.fillStyle=i==0?'#00ADB5':'#EEE';sctx.fillRect(snk[i].x,snk[i].y,15,15);}
            sctx.fillStyle='#FF2E63';sctx.fillRect(sfd.x,sfd.y,15,15);
            let h={x:snk[0].x,y:snk[0].y};
            if(sd=='LEFT')h.x-=15;if(sd=='UP')h.y-=15;if(sd=='RIGHT')h.x+=15;if(sd=='DOWN')h.y+=15;
            if(h.x==sfd.x&&h.y==sfd.y){ssc++;document.getElementById('snake-score').innerText=ssc;sfd={x:Math.floor(Math.random()*19)*15,y:Math.floor(Math.random()*19)*15};}else snk.pop();
            if(h.x<0||h.x>=300||h.y<0||h.y>=300||snk.some(s=>s.x==h.x&&s.y==h.y)){clearInterval(intervals[0]);alert("Game Over: "+ssc);}else snk.unshift(h);
        }

        // 7. Mole
        let msc=0,mt=30;
        function createMoleGrid(){const g=document.getElementById('mole-grid');g.innerHTML='';for(let i=0;i<9;i++){let d=document.createElement('div');d.className='mole-hole';d.id=`mh-${i}`;d.innerHTML='<div class="mole"></div>';d.onclick=()=>bonk(i);g.appendChild(d);}}
        function startMole(){msc=0;mt=30;document.getElementById('mole-score').innerText=0;document.getElementById('mole-time').innerText=30;peep();intervals.push(setInterval(()=>{mt--;document.getElementById('mole-time').innerText=mt;if(mt<=0){intervals.forEach(clearInterval);alert("æ™‚é–“åˆ°: "+msc);}},1000));}
        function peep(){if(mt<=0)return;let h=document.getElementById(`mh-${Math.floor(Math.random()*9)}`);h.classList.add('active');setTimeout(()=>{h.classList.remove('active');if(mt>0)setTimeout(peep,300+Math.random()*500);},500+Math.random()*500);}
        function bonk(i){let h=document.getElementById(`mh-${i}`);if(h.classList.contains('active')){msc++;document.getElementById('mole-score').innerText=msc;h.classList.remove('active');}}

        // 8. Memory
        let mc=[],hasF=false,lk=false,fc,scrd;
        function initMemory(){const g=document.getElementById('memory-grid');g.innerHTML='';mc=['ğŸ','ğŸ','ğŸŒ','ğŸŒ','ğŸ‡','ğŸ‡','ğŸ‰','ğŸ‰','ğŸ¶','ğŸ¶','ğŸ±','ğŸ±','ğŸ¦Š','ğŸ¦Š','ğŸ¸','ğŸ¸'].sort(()=>0.5-Math.random());mc.forEach(i=>{let c=document.createElement('div');c.className='memory-card';c.dataset.f=i;c.innerText=i;c.onclick=flipC;g.appendChild(c);});hasF=false;lk=false;}
        function flipC(){if(lk||this===fc)return;this.classList.add('flipped');if(!hasF){hasF=true;fc=this;return;}scrd=this;lk=true;if(fc.dataset.f===scrd.dataset.f){fc.classList.add('matched');scrd.classList.add('matched');resetB();}else{setTimeout(()=>{fc.classList.remove('flipped');scrd.classList.remove('flipped');resetB();},1000);}}
        function resetB(){[hasF,lk]=[false,false];[fc,scrd]=[null,null];}

        // 9. Dodge
        let dpx=135,dms=[],dsc=0,dmv=0; const dct=document.getElementById('dodge-canvas').getContext('2d');
        function startDodge(){if(document.activeElement)document.activeElement.blur();dpx=135;dms=[];dsc=0;dmv=0;document.getElementById('dodge-score').innerText="0";intervals.forEach(clearInterval);intervals.push(setInterval(updDodge,20));intervals.push(setInterval(()=>{dms.push({x:Math.random()*280,y:-20,s:2+Math.random()*3});dsc++;document.getElementById('dodge-score').innerText=(dsc/10).toFixed(1);},500));}
        function dodgeKey(k,d){if(k=='ArrowLeft'||k=='a')dmv=d?-4:0;if(k=='ArrowRight'||k=='d')dmv=d?4:0;}
        function updDodge(){dct.fillStyle='#222831';dct.fillRect(0,0,300,300);dpx+=dmv;if(dpx<0)dpx=0;if(dpx>280)dpx=280;dct.fillStyle='#00ADB5';dct.beginPath();dct.moveTo(dpx+10,270);dct.lineTo(dpx,290);dct.lineTo(dpx+20,290);dct.fill();dct.fillStyle='#FF2E63';dms.forEach(m=>{m.y+=m.s;dct.beginPath();dct.arc(m.x,m.y,8,0,6.28);dct.fill();});if(dms.some(m=>m.x>dpx-5&&m.x<dpx+25&&m.y>270&&m.y<290)){intervals.forEach(clearInterval);alert("Game Over: "+(dsc/10));}}

        // 10. Math
        let mA,mB;
        function initMath(){mA=Math.floor(Math.random()*20)+1;mB=Math.floor(Math.random()*20)+1;document.getElementById('math-question').innerText=`${mA} + ${mB} = ?`;}
        function checkMath(){let v=parseInt(document.getElementById('math-input').value);let s=document.getElementById('math-score');if(v===mA+mB){s.innerText=parseInt(s.innerText)+1;document.getElementById('math-input').value='';initMath();}else{alert("éŒ¯äº†! æ­¸é›¶");s.innerText=0;document.getElementById('math-input').value='';}}

        // 11. Breakout
        let bPX=110,bBall={x:150,y:250,dx:3,dy:-3},bBrks=[],bSc=0,bMv=0; const bctx=document.getElementById('break-canvas').getContext('2d');
        function startBreakout(){if(document.activeElement)document.activeElement.blur();bPX=110;bBall={x:150,y:250,dx:3,dy:-3};bSc=0;bBrks=[];bMv=0;document.getElementById('break-score').innerText=0;for(let c=0;c<5;c++)for(let r=0;r<4;r++)bBrks.push({x:c*60+5,y:r*30+30,s:1});intervals.forEach(clearInterval);intervals.push(setInterval(drBrk,20));}
        function breakKey(k,d){if(k=='ArrowLeft'||k=='a')bMv=d?-5:0;if(k=='ArrowRight'||k=='d')bMv=d?5:0;}
        function drBrk(){
            bctx.fillStyle='#222831';bctx.fillRect(0,0,300,300);bPX+=bMv;if(bPX<0)bPX=0;if(bPX>220)bPX=220;bctx.fillStyle='#00ADB5';bctx.fillRect(bPX,280,80,10);
            bBrks.forEach(b=>{if(b.s){bctx.fillStyle='#FF2E63';bctx.fillRect(b.x,b.y,50,20);if(bBall.x>b.x&&bBall.x<b.x+50&&bBall.y>b.y&&bBall.y<b.y+20){bBall.dy=-bBall.dy;b.s=0;bSc++;document.getElementById('break-score').innerText=bSc;}}});
            bBall.x+=bBall.dx;bBall.y+=bBall.dy;if(bBall.x<0||bBall.x>300)bBall.dx=-bBall.dx;if(bBall.y<0)bBall.dy=-bBall.dy;if(bBall.y>300){intervals.forEach(clearInterval);alert("Game Over");return;}
            if(bBall.y>270&&bBall.y<280&&bBall.x>bPX&&bBall.x<bPX+80)bBall.dy=-Math.abs(bBall.dy);bctx.beginPath();bctx.arc(bBall.x,bBall.y,5,0,6.28);bctx.fillStyle='#fff';bctx.fill();
        }

        // 12. Minesweeper
        let msG=[],msM=[],msR=0,msGO=false;
        function initMinesweeper(){const g=document.getElementById('minesweeper-grid');g.innerHTML='';g.style.gridTemplateColumns='repeat(8, 1fr)';document.getElementById('mine-msg').innerText='';msM=[];msR=0;msGO=false;let idx=Array(64).fill(0).map((_,i)=>i).sort(()=>Math.random()-0.5);let bmbs=idx.slice(0,8);for(let i=0;i<64;i++){let d=document.createElement('div');d.className='mine-cell';d.onclick=()=>clkMine(i,bmbs);if(bmbs.includes(i))msM.push(i);g.appendChild(d);}}
        function clkMine(i,bmbs){if(msGO)return;let cs=document.querySelectorAll('.mine-cell');if(bmbs.includes(i)){cs[i].classList.add('bomb');cs[i].innerText='ğŸ’£';document.getElementById('mine-msg').innerText="ğŸ’¥ çˆ†ç‚¸!";msGO=true;bmbs.forEach(b=>{cs[b].classList.add('bomb');cs[b].innerText='ğŸ’£';});}else{let c=0,adj=[-9,-8,-7,-1,1,7,8,9];adj.forEach(a=>{let n=i+a;if(n>=0&&n<64&&Math.abs((n%8)-(i%8))<=1&&bmbs.includes(n))c++;});cs[i].classList.add('revealed');cs[i].innerText=c>0?c:'';cs[i].onclick=null;msR++;if(msR===56){document.getElementById('mine-msg').innerText="ğŸ‰ æˆåŠŸ!";msGO=true;}}}

        // 13. Slots
        function spinSlots(){let m=document.getElementById('slot-msg');m.innerText="...";let rs=[document.getElementById('reel1'),document.getElementById('reel2'),document.getElementById('reel3')],res=[];rs.forEach((r,i)=>{let c=0,iv=setInterval(()=>{r.innerText=Math.floor(Math.random()*9)+1;c++;if(c>10+i*5){clearInterval(iv);let f=Math.floor(Math.random()*9)+1;r.innerText=f;res.push(f);if(res.length===3){m.innerText=(res[0]==res[1]&&res[1]==res[2])?"ğŸ‰ ä¸­ç!":"å†è©¦ä¸€æ¬¡";}}},50);});}

        // 14. Simon
        let simQ=[],simU=[],simL=1,simT=false;
        function startSimon(){simQ=[];simL=1;nxtSim();}
        function nxtSim(){simU=[];simT=false;document.getElementById('simon-level').innerText=simL;document.getElementById('simon-msg').innerText="çœ‹ä»”ç´°...";simQ.push(Math.floor(Math.random()*4));let i=0,iv=setInterval(()=>{flshSim(simQ[i]);i++;if(i>=simQ.length){clearInterval(iv);simT=true;document.getElementById('simon-msg').innerText="æ›ä½ ";}},600);}
        function flshSim(i){let b=document.getElementById(`sb-${i}`);b.classList.add('lit');setTimeout(()=>b.classList.remove('lit'),300);}
        function handleSimonInput(i){if(!simT)return;flshSim(i);simU.push(i);if(simU[simU.length-1]!==simQ[simU.length-1]){document.getElementById('simon-msg').innerText="âŒ éŒ¯èª¤!";simT=false;return;}if(simU.length===simQ.length){simT=false;simL++;document.getElementById('simon-msg').innerText="âœ… æ­£ç¢º!";setTimeout(nxtSim,1000);}}

        // 15. Puzzle
        let pT=[];
        function initPuzzle(){pT=Array(16).fill(0).map((_,i)=>i);for(let i=0;i<200;i++){let e=pT.indexOf(15),n=[],dirs=[-1,1,-4,4];dirs.forEach(d=>{let t=e+d;if(t>=0&&t<16&&!(e%4==0&&d==-1)&&!(e%4==3&&d==1))n.push(t);});let s=n[Math.floor(Math.random()*n.length)];[pT[e],pT[s]]=[pT[s],pT[e]];}renPuz();}
        function renPuz(){const g=document.getElementById('puzzle-grid');g.innerHTML='';pT.forEach((v,i)=>{let d=document.createElement('div');d.className=`puzzle-tile ${v===15?'empty':''}`;d.innerText=v===15?'':v+1;d.onclick=()=>mvTile(i);g.appendChild(d);});let w=true;for(let i=0;i<15;i++)if(pT[i]!==i)w=false;document.getElementById('puzzle-msg').innerText=w?"ğŸ‰ å®Œæˆ!":"æ’åˆ— 1-15";}
        function mvTile(i){let e=pT.indexOf(15);if(Math.abs(i-e)===4||(Math.abs(i-e)===1&&Math.floor(i/4)===Math.floor(e/4))){[pT[i],pT[e]]=[pT[e],pT[i]];renPuz();}}

        // --- NEW GAMES 16-20 ---

        // 16. Tetris (Mini Version)
        const tCtx = document.getElementById('tetris-canvas').getContext('2d');
        const ROW=20, COL=12, SQ=20; 
        let tBoard=[], tPiece, tScore=0, tDropStart;
        const PIECES = [ [Z,"red"], [S,"green"], [T,"purple"], [O,"yellow"], [L,"orange"], [I,"cyan"], [J,"blue"] ];
        function Z(){return[[1,1,0],[0,1,1],[0,0,0]];} function S(){return[[0,1,1],[1,1,0],[0,0,0]];} function T(){return[[0,1,0],[1,1,1],[0,0,0]];}
        function O(){return[[0,0,0,0],[0,1,1,0],[0,1,1,0],[0,0,0,0]];} function L(){return[[0,0,1],[1,1,1],[0,0,0]];} function I(){return[[0,1,0,0],[0,1,0,0],[0,1,0,0],[0,1,0,0]];} function J(){return[[1,0,0],[1,1,1],[0,0,0]];}
        
        function drawSquare(x,y,c){ tCtx.fillStyle=c; tCtx.fillRect(x*SQ,y*SQ,SQ,SQ); tCtx.strokeStyle="#333"; tCtx.strokeRect(x*SQ,y*SQ,SQ,SQ); }
        function startTetris(){
            if(document.activeElement)document.activeElement.blur();
            tBoard=[]; for(let r=0;r<ROW;r++) tBoard[r]=Array(COL).fill("BLACK");
            tPiece = randomPiece(); tScore=0; document.getElementById('tetris-score').innerText=0;
            intervals.forEach(clearInterval);
            tDropStart = Date.now();
            intervals.push(setInterval(updateTetris, 1000/60)); // Game loop
        }
        function randomPiece(){ let r = Math.floor(Math.random()*PIECES.length); return { active:PIECES[r][0](), color:PIECES[r][1], x:4, y:0 }; }
        function drawTetris(){
            tCtx.fillStyle="black"; tCtx.fillRect(0,0,240,400);
            for(let r=0;r<ROW;r++) for(let c=0;c<COL;c++) drawSquare(c,r,tBoard[r][c]);
            for(let r=0;r<tPiece.active.length;r++) for(let c=0;c<tPiece.active.length;c++) if(tPiece.active[r][c]) drawSquare(tPiece.x+c, tPiece.y+r, tPiece.color);
        }
        function moveTetris(x,y,p){
            for(let r=0;r<p.length;r++) for(let c=0;c<p.length;c++){
                if(!p[r][c]) continue;
                let newX = tPiece.x + c + x; let newY = tPiece.y + r + y;
                if(newX<0 || newX>=COL || newY>=ROW) return true;
                if(newY<0) continue;
                if(tBoard[newY][newX] != "BLACK") return true;
            } return false;
        }
        function updateTetris(){
            let now = Date.now(); if(now - tDropStart > 500){
                if(!moveTetris(0,1,tPiece.active)) tPiece.y++;
                else {
                    lockTetris(); tPiece=randomPiece();
                    if(moveTetris(0,0,tPiece.active)) { intervals.forEach(clearInterval); alert("Game Over"); }
                }
                tDropStart = Date.now();
            }
            drawTetris();
        }
        function lockTetris(){
            for(let r=0;r<tPiece.active.length;r++) for(let c=0;c<tPiece.active.length;c++) if(tPiece.active[r][c] && (tPiece.y+r)>=0) tBoard[tPiece.y+r][tPiece.x+c] = tPiece.color;
            for(let r=0;r<ROW;r++){
                let isFull = true; for(let c=0;c<COL;c++) if(tBoard[r][c]=="BLACK") isFull=false;
                if(isFull){ tScore+=10; document.getElementById('tetris-score').innerText=tScore; for(let y=r; y>1; y--) for(let c=0;c<COL;c++) tBoard[y][c]=tBoard[y-1][c]; for(let c=0;c<COL;c++) tBoard[0][c]="BLACK"; }
            }
        }
        function tetrisKey(k){
            if(k=="ArrowLeft" && !moveTetris(-1,0,tPiece.active)) tPiece.x--;
            if(k=="ArrowRight" && !moveTetris(1,0,tPiece.active)) tPiece.x++;
            if(k=="ArrowDown" && !moveTetris(0,1,tPiece.active)) tPiece.y++;
            if(k=="ArrowUp"){
                let nextPattern = tPiece.active[0].map((val, index) => tPiece.active.map(row => row[index]).reverse());
                if(!moveTetris(0,0,nextPattern)) tPiece.active = nextPattern;
            }
        }

        // 17. Flappy Bird
        const birdCtx = document.getElementById('bird-canvas').getContext('2d');
        let bird={x:50,y:150,v:0}, pipes=[], birdScore=0, birdFrame=0;
        function startBird(){
            if(document.activeElement)document.activeElement.blur();
            bird={x:50,y:150,v:0}; pipes=[]; birdScore=0; birdFrame=0; document.getElementById('bird-score').innerText=0;
            intervals.forEach(clearInterval); intervals.push(setInterval(updateBird, 20));
            // Add click listener for mouse
            document.getElementById('bird-canvas').onmousedown = ()=>bird.v = -4.5;
        }
        function updateBird(){
            birdCtx.fillStyle = "#70c5ce"; birdCtx.fillRect(0,0,300,400); // Sky
            bird.v += 0.25; bird.y += bird.v; // Gravity
            birdCtx.fillStyle = "#FF2E63"; birdCtx.fillRect(bird.x, bird.y, 20, 20); // Bird
            
            if(birdFrame%100 === 0) { let gap=100, h=Math.random()*200+50; pipes.push({x:300, top:h, bot:h+gap}); }
            birdFrame++;

            for(let i=0; i<pipes.length; i++){
                let p = pipes[i]; p.x -= 2;
                birdCtx.fillStyle = "#00ADB5";
                birdCtx.fillRect(p.x, 0, 40, p.top); // Top pipe
                birdCtx.fillRect(p.x, p.bot, 40, 400-p.bot); // Bot pipe
                
                if(bird.x+20 > p.x && bird.x < p.x+40 && (bird.y < p.top || bird.y+20 > p.bot)){ intervals.forEach(clearInterval); alert("æ’åˆ°äº†! åˆ†æ•¸: "+birdScore); }
                if(p.x === 10) { birdScore++; document.getElementById('bird-score').innerText=birdScore; }
            }
            if(bird.y>400 || bird.y<0) { intervals.forEach(clearInterval); alert("å¢œæ©Ÿ! åˆ†æ•¸: "+birdScore); }
        }
        function birdKey(k){ if(k===" " || k==="ArrowUp") bird.v = -4.5; }

        // 18. Pong
        const pCtx = document.getElementById('pong-canvas').getContext('2d');
        let ball={x:200,y:150,dx:4,dy:4}, p1Y=110, p2Y=110, pScore=[0,0], pMove=0;
        function startPong(){
            if(document.activeElement)document.activeElement.blur();
            ball={x:200,y:150,dx:4,dy:4}; p1Y=110; p2Y=110; pScore=[0,0]; pMove=0;
            document.getElementById('pong-user').innerText=0; document.getElementById('pong-cpu').innerText=0;
            intervals.forEach(clearInterval); intervals.push(setInterval(updatePong, 20));
        }
        function updatePong(){
            pCtx.fillStyle="#222831"; pCtx.fillRect(0,0,400,300);
            p1Y += pMove; if(p1Y<0)p1Y=0; if(p1Y>220)p1Y=220; // Player
            // CPU AI
            if(ball.y < p2Y+30) p2Y -= 3; else if(ball.y > p2Y+50) p2Y += 3;
            if(p2Y<0)p2Y=0; if(p2Y>220)p2Y=220;

            pCtx.fillStyle="#fff";
            pCtx.fillRect(0, p1Y, 10, 80); // P1
            pCtx.fillRect(390, p2Y, 10, 80); // CPU
            pCtx.fillRect(ball.x, ball.y, 8, 8); // Ball
            
            ball.x += ball.dx; ball.y += ball.dy;
            if(ball.y<=0 || ball.y>=292) ball.dy *= -1;
            
            // Collision Paddle
            if(ball.x<=10 && ball.y>=p1Y && ball.y<=p1Y+80) { ball.dx = Math.abs(ball.dx)+0.2; }
            if(ball.x>=382 && ball.y>=p2Y && ball.y<=p2Y+80) { ball.dx = -Math.abs(ball.dx)-0.2; }

            // Score
            if(ball.x<0) { pScore[1]++; resetBall(); }
            if(ball.x>400) { pScore[0]++; resetBall(); }
            document.getElementById('pong-user').innerText=pScore[0]; document.getElementById('pong-cpu').innerText=pScore[1];
        }
        function resetBall(){ ball.x=200; ball.y=150; ball.dx = (Math.random()>0.5?1:-1)*4; ball.dy=4; }
        function pongKey(k,d){ if(k=='w'||k=='ArrowUp') pMove=d?-6:0; if(k=='s'||k=='ArrowDown') pMove=d?6:0; }

        // 19. 2048
        let g2048 = [], s2048=0;
        function init2048(){
            g2048 = Array(16).fill(0); s2048=0;
            spawn2048(); spawn2048(); render2048();
            document.getElementById('g2048-score').innerText=0;
            if(document.activeElement)document.activeElement.blur();
        }
        function spawn2048(){
            let empty = g2048.map((v,i)=>v===0?i:null).filter(v=>v!==null);
            if(empty.length) g2048[empty[Math.floor(Math.random()*empty.length)]] = Math.random()<0.9 ? 2 : 4;
        }
        function render2048(){
            const g = document.getElementById('grid-2048'); g.innerHTML='';
            g2048.forEach(v=>{
                let d=document.createElement('div'); d.className=`tile-2048 t${v}`; d.innerText=v||'';
                g.appendChild(d);
            });
        }
        function handle2048(k){
            let old = [...g2048];
            if(k==="ArrowLeft") move2048(0,1,2,3, 1);
            if(k==="ArrowRight") move2048(3,2,1,0, -1);
            if(k==="ArrowUp") move2048(0,4,8,12, 4);
            if(k==="ArrowDown") move2048(12,8,4,0, -4);
            if(JSON.stringify(old) !== JSON.stringify(g2048)) { spawn2048(); render2048(); }
        }
        function move2048(i1, i2, i3, i4, step){ // Generalized row/col processor
            // Simplified: process 4 groups (rows or cols)
            for(let i=0; i<4; i++){
                let offset = (step===1||step===-1) ? i*4 : i; // Row vs Col offset
                let indices = [i1, i2, i3, i4].map(x => (step===1||step===-1) ? x+offset : x+offset); 
                // Logic: Extract -> Filter 0 -> Merge -> Pad 0
                let row = indices.map(idx => g2048[idx]).filter(v=>v);
                for(let j=0; j<row.length-1; j++){
                    if(row[j]===row[j+1]){ row[j]*=2; s2048+=row[j]; row.splice(j+1,1); document.getElementById('g2048-score').innerText=s2048; }
                }
                while(row.length<4) row.push(0);
                indices.forEach((idx, n) => g2048[idx] = row[n]);
            }
        }

        // 20. Hangman
        const hWords = ["PYTHON", "JAVASCRIPT", "HTML", "CSS", "REACT", "ANGULAR", "NODE", "LINUX", "SERVER", "DATABASE"];
        let hWord="", hGuess=[], hErr=0;
        function initHangman(){
            hWord = hWords[Math.floor(Math.random()*hWords.length)];
            hGuess = Array(hWord.length).fill("_"); hErr=0;
            document.getElementById('hangman-word').innerText = hGuess.join(" ");
            document.getElementById('hangman-msg').innerText = "çŒœçŒœç¨‹å¼èªè¨€å–®å­—";
            renderHangmanKeys(); drawHangman();
        }
        function renderHangmanKeys(){
            const k = document.getElementById('hangman-keys'); k.innerHTML='';
            for(let i=65; i<=90; i++){
                let l = String.fromCharCode(i);
                let b = document.createElement('button'); b.className='key-btn'; b.innerText=l;
                b.onclick = ()=>guessHangman(l, b);
                k.appendChild(b);
            }
        }
        function guessHangman(l, btn){
            btn.disabled=true;
            if(hWord.includes(l)){
                for(let i=0; i<hWord.length; i++) if(hWord[i]===l) hGuess[i]=l;
                document.getElementById('hangman-word').innerText = hGuess.join(" ");
                if(!hGuess.includes("_")) document.getElementById('hangman-msg').innerText = "ğŸ‰ ç­”å°äº†!";
            } else {
                hErr++; drawHangman();
                if(hErr>=6) { document.getElementById('hangman-msg').innerText = "ğŸ’€ è¼¸äº†: "+hWord; document.querySelectorAll('.key-btn').forEach(b=>b.disabled=true); }
            }
        }
        function drawHangman(){
            const c = document.getElementById('hangman-canvas').getContext('2d');
            c.strokeStyle="#fff"; c.lineWidth=3;
            if(hErr===0) c.clearRect(0,0,200,150);
            if(hErr===0) { c.beginPath(); c.moveTo(10,140); c.lineTo(190,140); c.moveTo(50,140); c.lineTo(50,20); c.lineTo(120,20); c.lineTo(120,40); c.stroke(); }
            if(hErr>=1) { c.beginPath(); c.arc(120,55,15,0,6.28); c.stroke(); } // Head
            if(hErr>=2) { c.beginPath(); c.moveTo(120,70); c.lineTo(120,110); c.stroke(); } // Body
            if(hErr>=3) { c.beginPath(); c.moveTo(120,80); c.lineTo(100,100); c.stroke(); } // L Arm
            if(hErr>=4) { c.beginPath(); c.moveTo(120,80); c.lineTo(140,100); c.stroke(); } // R Arm
            if(hErr>=5) { c.beginPath(); c.moveTo(120,110); c.lineTo(100,130); c.stroke(); } // L Leg
            if(hErr>=6) { c.beginPath(); c.moveTo(120,110); c.lineTo(140,130); c.stroke(); } // R Leg
        }

    </script>
</body>
</html>
